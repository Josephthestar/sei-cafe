{"ast":null,"code":"import _regeneratorRuntime from\"/Users/josephrihan/Desktop/Software_Engineering_Immersive/sei-cafe/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/josephrihan/Desktop/Software_Engineering_Immersive/sei-cafe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// Service modules export business/app logic\n// such as managing tokens, etc.\n// Service modules often depend upon API modules\n// for making AJAX requests to the server.\nimport*as usersAPI from'./users-api';export function signUp(_x){return _signUp.apply(this,arguments);}function _signUp(){_signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userData){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return usersAPI.signUp(userData);case 2:token=_context.sent;localStorage.setItem('token',token);return _context.abrupt(\"return\",getUser());case 5:case\"end\":return _context.stop();}}},_callee);}));return _signUp.apply(this,arguments);}export function login(_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(credentials){var token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return usersAPI.login(credentials);case 2:token=_context2.sent;localStorage.setItem('token',token);return _context2.abrupt(\"return\",getUser());case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _login.apply(this,arguments);}export function logOut(){localStorage.removeItem('token');}export function getToken(){// getItem will return null if the key does not exists\nvar token=localStorage.getItem('token');if(!token)return null;var payload=JSON.parse(atob(token.split('.')[1]));// A JWT's exp is expressed in seconds, not miliseconds\nif(payload.exp*1000<Date.now()){// Token has expired\nlocalStorage.removeItem('token');return null;}return token;}export function getUser(){var token=getToken();return token?JSON.parse(atob(token.split('.')[1])).user:null;}","map":{"version":3,"names":["usersAPI","signUp","userData","token","localStorage","setItem","getUser","login","credentials","logOut","removeItem","getToken","getItem","payload","JSON","parse","atob","split","exp","Date","now","user"],"sources":["/Users/josephrihan/Desktop/Software_Engineering_Immersive/sei-cafe/src/utilities/users-service.js"],"sourcesContent":["// Service modules export business/app logic\n// such as managing tokens, etc.\n// Service modules often depend upon API modules\n// for making AJAX requests to the server.\n\nimport * as usersAPI from './users-api';\n\nexport async function signUp(userData) {\n  const token = await usersAPI.signUp(userData);\n  localStorage.setItem('token', token);\n  return getUser();\n}\n\nexport async function login(credentials) {\n  // Delegate the AJAX request to the users-api.js\n  // module.\n  const token = await usersAPI.login(credentials);\n  localStorage.setItem('token', token);\n  return getUser();\n}\n\nexport function logOut() {\n  localStorage.removeItem('token');\n}\n\nexport function getToken() {\n  // getItem will return null if the key does not exists\n  const token = localStorage.getItem('token');\n  if (!token) return null;\n  const payload = JSON.parse(atob(token.split('.')[1]));\n  // A JWT's exp is expressed in seconds, not miliseconds\n  if (payload.exp * 1000 < Date.now()) {\n    // Token has expired\n    localStorage.removeItem('token');\n    return null;\n  }\n  return token;\n}\n\nexport function getUser() {\n  const token = getToken();\n  return token ? JSON.parse(atob(token.split('.')[1])).user : null;\n}\n\n\n"],"mappings":"gUAAA;AACA;AACA;AACA;AAEA,MAAO,GAAKA,SAAQ,KAAM,aAAa,CAEvC,eAAsBC,OAAM,2CAI3B,qFAJM,iBAAsBC,QAAQ,oJACfF,SAAQ,CAACC,MAAM,CAACC,QAAQ,CAAC,QAAvCC,KAAK,eACXC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEF,KAAK,CAAC,CAAC,gCAC9BG,OAAO,EAAE,wDACjB,yCAED,eAAsBC,MAAK,2CAM1B,mFANM,kBAAqBC,WAAW,yJAGjBR,SAAQ,CAACO,KAAK,CAACC,WAAW,CAAC,QAAzCL,KAAK,gBACXC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEF,KAAK,CAAC,CAAC,iCAC9BG,OAAO,EAAE,0DACjB,wCAED,MAAO,SAASG,OAAM,EAAG,CACvBL,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC,CAClC,CAEA,MAAO,SAASC,SAAQ,EAAG,CACzB;AACA,GAAMR,MAAK,CAAGC,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACT,KAAK,CAAE,MAAO,KAAI,CACvB,GAAMU,QAAO,CAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACb,KAAK,CAACc,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACrD;AACA,GAAIJ,OAAO,CAACK,GAAG,CAAG,IAAI,CAAGC,IAAI,CAACC,GAAG,EAAE,CAAE,CACnC;AACAhB,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC,CAChC,MAAO,KAAI,CACb,CACA,MAAOP,MAAK,CACd,CAEA,MAAO,SAASG,QAAO,EAAG,CACxB,GAAMH,MAAK,CAAGQ,QAAQ,EAAE,CACxB,MAAOR,MAAK,CAAGW,IAAI,CAACC,KAAK,CAACC,IAAI,CAACb,KAAK,CAACc,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACI,IAAI,CAAG,IAAI,CAClE"},"metadata":{},"sourceType":"module","externalDependencies":[]}